{% extends "base.html" %}

{% block content %}

  <canvas id="myChart1" width="400" height="100"></canvas>
  <canvas id="myChart2" width="400" height="100"></canvas>
  <canvas id="myChart3" width="400" height="100"></canvas>
  <canvas id="myChart4" width="400" height="100"></canvas>
  <canvas id="myChart5" width="400" height="100"></canvas>
  <canvas id="myChart6" width="400" height="100"></canvas>
  <canvas id="myChart7" width="400" height="100"></canvas>
  <canvas id="myChart8" width="400" height="100"></canvas>

  {% if object_list %}
    <table>
      <tr>
        <th>Date</th>
        <th>Chest</th>
        <th>Abdomen</th>
        <th>Thigh</th>
        <th>Total</th>
        <th>Body Fat Percentage</th>
      </tr>
      {% for measurement in measurements %}
      <tr>
        <td><a href="{% url 'tracker:detail' measurement.id %}">{{ measurement.created }}</a></li>
        <td>{{ measurement.chest }}</td>
        <td>{{ measurement.abdomen }}</td>
        <td>{{ measurement.thigh }}</td>
        <td>{{ measurement.get_total_measurement }}</td>
        <td>{{ measurement.weight }}</td>
        <td>{{ measurement.get_body_fat_percentage }}</td>
      </tr>
      {% endfor %}
    </table>
  {% else %}
    <p>No measurements available.</p>
  {% endif %}

{% endblock content %}

{% block javascript %}

  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

  <script type="text/javascript">
    // TODO specify which chart canvas and create dynamically
    var ctx1 = document.getElementById('myChart1');
    var ctx2 = document.getElementById('myChart2');
    var ctx3 = document.getElementById('myChart3');
    var ctx4 = document.getElementById('myChart4');
    var ctx5 = document.getElementById('myChart5');
    var ctx6 = document.getElementById('myChart6');
    var ctx7 = document.getElementById('myChart7');
    var ctx8 = document.getElementById('myChart8');
    $.getJSON('{% url 'tracker:json' %}', function(data) {
      var myChart = new Chart(ctx1, {
        type: 'line',
        data: { "labels": data['labels'], "datasets": [data['datasets'][0]]}
      });
      var myChart = new Chart(ctx2, {
        type: 'line',
        data: { "labels": data['labels'], "datasets": [data['datasets'][1]]}
      });
      var myChart = new Chart(ctx3, {
        type: 'line',
        data: { "labels": data['labels'], "datasets": [data['datasets'][2]]}
      });
      var myChart = new Chart(ctx4, {
        type: 'line',
        data: { "labels": data['labels'], "datasets": [data['datasets'][3]]}
      });
      var myChart = new Chart(ctx5, {
        type: 'line',
        data: { "labels": data['labels'], "datasets": [data['datasets'][4]]}
      });
      var myChart = new Chart(ctx6, {
        type: 'line',
        data: { "labels": data['labels'], "datasets": [data['datasets'][5]]}
      });
      var myChart = new Chart(ctx7, {
        type: 'line',
        data: { "labels": data['labels'], "datasets": [data['datasets'][6]]}
      });
      var myChart = new Chart(ctx8, {
        type: 'line',
        data: { "labels": data['labels'], "datasets": [data['datasets'][7]]}
      });
    }).fail(function(jqXHR, textStatus, errorThrown) {
        console.log("error " + textStatus);
        console.log("incoming Text " + jqXHR.responseText);
    });
  </script>

{% endblock javascript %}
